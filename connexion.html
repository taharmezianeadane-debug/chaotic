<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscription</title>
    <link rel="stylesheet" href="formulaire.css">
    <link rel="icon" type="image/png" href="photo du site/logo.png"> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
</head>
<body>
    <section class="big_box">
        <div class="logo">
            <img src="photo du site/logo.png" alt="logo" class="logo-im">
            <h1>CHAOTIC .educ</h1>
        </div>

        <div class="paragra">
            <h1>INSCRIPTION</h1>
            <p>Ces inscriptions sont nécessaires pour vous accéder aux formations</p>
        </div>

        <form id="inscriptionForm"> 
            
            <div class="ligne">
                <div>
                    <label for="nom"><i class="fa-solid fa-user"></i> NOM:</label>
                    <input type="text" id="nom" name="nom" required>
                </div>
                <div>
                    <label for="prenom"><i class="fa-solid fa-user"></i> Prénom:</label>
                    <input type="text" id="prenom" name="prenom" required>
                </div>
                <div>
                    <label for="date_naissance"><i class="fa-solid fa-calendar"></i> Date de naissance:</label>
                    <input type="date" id="date_naissance" name="date_naissance" required>
                </div>
            </div>

            <div class="ligne">
                <div>
                    <label for="telephone"><i class="fa-solid fa-phone"></i> Tel:</label>
                    <input type="number" id="telephone" name="telephone" required>
                </div>
                <div>
                    <label for="email"><i class="fa-solid fa-envelope"></i> Gmail:</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div>
                    <label for="reseaux"><i class="fa-brands fa-facebook"></i> Réseaux:</label>
                    <input type="text" id="reseaux" name="reseaux" required>
                </div>
            </div>

            <div class="ligne">
                <div>
                    <label for="niveau"><i class="fa-solid fa-graduation-cap"></i> Niveau:</label>
                    <select id="niveau" name="niveau" required>
                        <option value="">-- Choisir --</option>
                        <option value="lycee">Lycée</option>
                        <option value="universite">Université</option>
                    </select>
                </div>
                <div>
                    <label for="annee"><i class="fa-solid fa-book"></i> Année d'étude:</label>
                    <select id="annee" name="annee" required>
                        <option value="">-- Choisir --</option>
                        <option value="terminal">Terminal</option>
                        <option value="info">Université Informatique</option>
                        <option value="st">Université ST</option>
                    </select>
                </div>
                <div>
                    <label for="autre"><i class="fa-solid fa-pen"></i> Autre:</label>
                    <input type="text" id="autre" name="autre" placeholder="Optionnel">
                </div>
            </div>

            <div class="ligne">
                <div>
                    <label for="interet"><i class="fa-solid fa-star"></i> Intérêt:</label>
                    <select id="interet" name="interet" required>
                        <option value="">-- Choisir --</option>
                        <option value="formation">Formation</option>
                        <option value="cours">Cours</option>
                        <option value="sujet">Sujet</option>
                    </select>
                </div>
                <div>
                    <label for="password"><i class="fa-solid fa-lock"></i> Mot de passe:</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <div>
                    <label for="confirm_password"><i class="fa-solid fa-lock"></i> Confirmer le mot de passe:</label>
                    <input type="password" id="confirm_password" name="confirm_password" required>
                </div>
            </div>

            <div class="btn">
                <button type="submit" id="submitButton">ENREGISTRER</button>
            </div>
        </form>
    </section>

    <script>
        // Votre URL Apps Script :
        const scriptURL = 'https://script.google.com/macros/s/AKfycbx9En6_dvLIp7Sxe7eX_jjbtKlXjZSJeD3L83QDqzbw3tvkQkhrqlSsVvhIU9xp_TzX/exec'; 

        const form = document.getElementById('inscriptionForm');
        const submitButton = document.getElementById('submitButton');

        form.addEventListener('submit', e => {
            e.preventDefault(); 
            
            // 1. Validation des mots de passe
            const password = document.getElementById('password').value;
            const confirm_password = document.getElementById('confirm_password').value;

            if (password !== confirm_password) {
                alert("Erreur : Les mots de passe ne correspondent pas.");
                return; 
            }
            
            submitButton.disabled = true; // Désactive le bouton

            // 2. Récupère toutes les données
            let requestBody = new FormData(form);

            // 3. Envoie les données en POST à l'URL du script
            fetch(scriptURL, { method: 'POST', body: requestBody })
                .then(response => {
                    const contentType = response.headers.get("content-type");
                    if (contentType && contentType.indexOf("application/json") !== -1) {
                        return response.json();
                    } else {
                        throw new Error('Réponse inattendue. Vérifiez le script et le déploiement.');
                    }
                })
                .then(data => {
                    if (data && data.result === 'success') {
                        alert('Inscription réussie ! Vos données ont été enregistrées.');
                        form.reset(); // Réinitialise le formulaire
                    } else if (data && data.result === 'error') {
                         alert('Erreur lors de l\'enregistrement : ' + (data.message || 'Vérifiez les en-têtes de colonnes.'));
                    } else {
                         alert('Erreur inattendue.');
                    }
                })
                .catch(error => {
                    console.error('Erreur de connexion/réseau:', error);
                    alert(`Erreur de soumission: ${error.message}`);
                })
                .finally(() => {
                    submitButton.disabled = false; // Réactive le bouton
                });
        });
    </script>
</body>
</html>